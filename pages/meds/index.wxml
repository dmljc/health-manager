<!-- æœè¯æ¨¡å—ï¼ˆç²¾ç®€åè°ƒç‰ˆï¼‰ -->
<view class="meds-page">
    <date-picker refresh-key="{{datePickerRefreshKey}}" bind:change="onDateChange" bind:monthchange="onMonthChange" />
    
    <view class="circle-wrapper">
        <view class="toggle-circle {{hasTakenToday ? 'circle--green' : 'circle--red'}} {{isToggling ? 'circle--press' : ''}}" bindtap="toggleMedicineStatus" hover-class="tap-active" hover-stay-time="80">
            <text class="circle-text">{{hasTakenToday ? 'å·²æœè¯' : 'æœªæœè¯'}}</text>
        </view>
        
        <!-- è¯ç‰©ä½™é‡æ˜¾ç¤º - åœ¨å¤§çº¢åœ†å³ä¾§ -->
        <view class="medicine-remaining" bind:tap="onMedicineCountTap">
            <text class="medicine-icon">ğŸ’Š</text>
            <text class="medicine-count">
                <text class="remaining-count {{medicineColorClass}}">{{medicineRemaining}}</text>
                <text class="number-slash">/</text>
                <text class="total-count">{{medicineTotal}}</text>
            </text>
        </view>
    </view>
    
    <!-- iOSé£æ ¼å¼¹æ¡† -->
    <view wx:if="{{showModal}}" class="modal-overlay modal-overlay--show" bindtap="closeModal">
        <view class="modal-container" catchtap="preventClose">
            <!-- æ ‡é¢˜ -->
            <text class="modal-title">ğŸ’Šè®¾ç½®è¯ç‰©æ€»é‡</text>
            
            <!-- å½“å‰ä¿¡æ¯ -->
            <view class="modal-current-info">
                <text class="current-text">è¯ç‰©æ€»é‡æŒ‡ä¸€ç›’æœ‰å¤šå°‘é¢—è¯</text>
            </view>
            <!-- è¾“å…¥åŒºåŸŸ -->
            <view class="modal-input-section">
                <view class="input-wrapper">
                    è¯ç‰©æ€»é‡:
                    <input class="modal-input" type="number" placeholder="è¯·è¾“å…¥æ•°é‡" value="{{modalTotalInput}}" bindinput="onModalTotalInput" focus="{{modalInputFocus}}"/>
                    é¢—
                </view>
            </view>
            
            <!-- æŒ‰é’®åŒºåŸŸ -->
            <view class="modal-actions">
                <button class="modal-btn modal-btn--neutral" bindtap="closeModal">å–æ¶ˆ</button>
                <button class="modal-btn modal-btn--primary" bindtap="confirmTotalChange">ç¡®è®¤</button>
            </view>
        </view>
    </view>
</view>